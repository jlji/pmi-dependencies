nohup: ignoring input
To use data.metrics please install scikit-learn. See https://scikit-learn.org/stable/index.html
  0%|          | 0/2416 [00:00<?, ?it/s]  0%|          | 1/2416 [00:00<12:06,  3.32it/s]  0%|          | 2/2416 [00:03<48:38,  1.21s/it]  0%|          | 3/2416 [00:05<53:25,  1.33s/it]  0%|          | 4/2416 [00:07<1:04:35,  1.61s/it]  0%|          | 5/2416 [00:08<57:10,  1.42s/it]    0%|          | 6/2416 [00:08<44:08,  1.10s/it]  0%|          | 7/2416 [00:10<48:08,  1.20s/it]  0%|          | 9/2416 [00:10<34:20,  1.17it/s]  0%|          | 10/2416 [00:12<53:16,  1.33s/it]  0%|          | 11/2416 [00:13<48:01,  1.20s/it]  0%|          | 12/2416 [00:13<37:06,  1.08it/s]  1%|          | 13/2416 [00:14<30:05,  1.33it/s]  1%|          | 14/2416 [00:15<35:34,  1.13it/s]  1%|          | 15/2416 [00:19<1:10:38,  1.77s/it]  1%|          | 16/2416 [00:19<52:36,  1.32s/it]    1%|          | 17/2416 [00:19<38:59,  1.03it/s]  1%|          | 19/2416 [00:20<32:04,  1.25it/s]  1%|          | 20/2416 [00:22<45:10,  1.13s/it]  1%|          | 22/2416 [00:25<47:54,  1.20s/it]  1%|          | 23/2416 [00:26<47:53,  1.20s/it]  1%|          | 24/2416 [00:27<43:01,  1.08s/it]  1%|          | 25/2416 [00:28<41:51,  1.05s/it]  1%|          | 26/2416 [00:28<31:25,  1.27it/s]  1%|          | 27/2416 [00:29<36:23,  1.09it/s]  1%|          | 28/2416 [00:30<33:24,  1.19it/s]  1%|          | 29/2416 [00:30<25:16,  1.57it/s]  1%|▏         | 31/2416 [00:31<21:44,  1.83it/s]  1%|▏         | 32/2416 [00:36<1:18:46,  1.98s/it]  1%|▏         | 34/2416 [00:37<1:00:10,  1.52s/it]  1%|▏         | 35/2416 [00:38<56:24,  1.42s/it]    1%|▏         | 36/2416 [00:39<48:58,  1.23s/it]  2%|▏         | 37/2416 [00:39<38:18,  1.04it/s]  2%|▏         | 38/2416 [00:39<30:47,  1.29it/s]  2%|▏         | 39/2416 [00:42<55:27,  1.40s/it]  2%|▏         | 40/2416 [00:43<45:39,  1.15s/it]  2%|▏         | 41/2416 [00:45<54:30,  1.38s/it]  2%|▏         | 42/2416 [00:45<41:16,  1.04s/it]  2%|▏         | 43/2416 [00:47<53:36,  1.36s/it]  2%|▏         | 44/2416 [00:47<39:23,  1.00it/s]  2%|▏         | 45/2416 [00:47<29:25,  1.34it/s]  2%|▏         | 46/2416 [00:50<49:20,  1.25s/it]  2%|▏         | 47/2416 [00:51<51:34,  1.31s/it]  2%|▏         | 48/2416 [00:53<55:05,  1.40s/it]  2%|▏         | 49/2416 [00:53<43:07,  1.09s/it]  2%|▏         | 51/2416 [00:54<32:00,  1.23it/s]  2%|▏         | 52/2416 [00:54<29:51,  1.32it/s]  2%|▏         | 53/2416 [00:55<32:32,  1.21it/s]  2%|▏         | 54/2416 [00:56<26:12,  1.50it/s]  2%|▏         | 55/2416 [00:56<28:54,  1.36it/s]  2%|▏         | 56/2416 [01:02<1:31:41,  2.33s/it]  2%|▏         | 57/2416 [01:04<1:18:25,  1.99s/it]  2%|▏         | 58/2416 [01:05<1:09:03,  1.76s/it]  2%|▏         | 60/2416 [01:06<53:02,  1.35s/it]    3%|▎         | 61/2416 [01:06<46:28,  1.18s/it]  3%|▎         | 62/2416 [01:07<37:07,  1.06it/s]  3%|▎         | 63/2416 [01:07<30:31,  1.28it/s]  3%|▎         | 64/2416 [01:08<31:49,  1.23it/s]  3%|▎         | 65/2416 [01:10<46:34,  1.19s/it]  3%|▎         | 66/2416 [01:11<37:46,  1.04it/s]  3%|▎         | 67/2416 [01:12<39:15,  1.00s/it]  3%|▎         | 68/2416 [01:13<41:34,  1.06s/it]  3%|▎         | 69/2416 [01:15<53:24,  1.37s/it]  3%|▎         | 70/2416 [01:18<1:10:29,  1.80s/it]  3%|▎         | 71/2416 [01:18<51:25,  1.32s/it]    3%|▎         | 72/2416 [01:18<38:27,  1.02it/s]  3%|▎         | 73/2416 [01:19<35:26,  1.10it/s]  3%|▎         | 74/2416 [01:20<38:57,  1.00it/s]  3%|▎         | 76/2416 [01:21<33:18,  1.17it/s]  3%|▎         | 77/2416 [01:22<26:36,  1.46it/s]  3%|▎         | 78/2416 [01:23<40:51,  1.05s/it]  3%|▎         | 79/2416 [01:24<31:04,  1.25it/s]  3%|▎         | 80/2416 [01:25<33:26,  1.16it/s]  3%|▎         | 81/2416 [01:25<26:39,  1.46it/s]  3%|▎         | 82/2416 [01:25<21:55,  1.77it/s]  3%|▎         | 83/2416 [01:26<25:48,  1.51it/s]  3%|▎         | 84/2416 [01:27<23:51,  1.63it/s]  4%|▎         | 85/2416 [01:30<58:02,  1.49s/it]  4%|▎         | 86/2416 [01:31<48:01,  1.24s/it]  4%|▎         | 87/2416 [01:32<45:10,  1.16s/it]  4%|▎         | 88/2416 [01:33<48:16,  1.24s/it]  4%|▎         | 90/2416 [01:33<34:26,  1.13it/s]  4%|▍         | 91/2416 [01:34<29:16,  1.32it/s]  4%|▍         | 92/2416 [01:35<30:54,  1.25it/s]  4%|▍         | 93/2416 [01:37<43:53,  1.13s/it]  4%|▍         | 94/2416 [01:37<36:34,  1.06it/s]  4%|▍         | 95/2416 [01:39<46:00,  1.19s/it]  4%|▍         | 96/2416 [01:40<46:13,  1.20s/it]  4%|▍         | 97/2416 [01:42<52:37,  1.36s/it]  4%|▍         | 98/2416 [01:44<58:58,  1.53s/it]  4%|▍         | 99/2416 [01:46<1:03:11,  1.64s/it]  4%|▍         | 100/2416 [01:46<45:32,  1.18s/it]   4%|▍         | 102/2416 [01:47<36:28,  1.06it/s]  4%|▍         | 103/2416 [01:47<32:08,  1.20it/s]  4%|▍         | 104/2416 [01:50<58:03,  1.51s/it]  4%|▍         | 105/2416 [01:51<52:08,  1.35s/it]  4%|▍         | 106/2416 [01:52<42:16,  1.10s/it]  4%|▍         | 107/2416 [01:54<59:52,  1.56s/it]  4%|▍         | 108/2416 [01:55<52:13,  1.36s/it]  5%|▍         | 109/2416 [02:03<2:06:58,  3.30s/it]  5%|▍         | 110/2416 [02:04<1:37:13,  2.53s/it]  5%|▍         | 111/2416 [02:06<1:32:03,  2.40s/it]  5%|▍         | 112/2416 [02:06<1:05:54,  1.72s/it]  5%|▍         | 113/2416 [02:11<1:43:31,  2.70s/it]  5%|▍         | 114/2416 [02:12<1:21:41,  2.13s/it]  5%|▍         | 115/2416 [02:13<1:09:44,  1.82s/it]  5%|▍         | 116/2416 [02:22<2:31:03,  3.94s/it]  5%|▍         | 117/2416 [02:23<1:57:07,  3.06s/it]  5%|▍         | 118/2416 [02:24<1:40:24,  2.62s/it]  5%|▍         | 119/2416 [02:25<1:21:36,  2.13s/it]  5%|▍         | 120/2416 [02:26<59:37,  1.56s/it]    5%|▌         | 121/2416 [02:26<48:19,  1.26s/it]  5%|▌         | 122/2416 [02:27<40:21,  1.06s/it]  5%|▌         | 123/2416 [02:27<32:05,  1.19it/s]  5%|▌         | 124/2416 [02:29<50:17,  1.32s/it]  5%|▌         | 125/2416 [02:30<38:14,  1.00s/it]  5%|▌         | 126/2416 [02:30<30:44,  1.24it/s]  5%|▌         | 127/2416 [02:32<38:11,  1.00s/it]  5%|▌         | 128/2416 [02:32<29:44,  1.28it/s]  5%|▌         | 129/2416 [02:32<22:17,  1.71it/s]  5%|▌         | 130/2416 [02:32<21:19,  1.79it/s]  5%|▌         | 131/2416 [02:34<33:17,  1.14it/s]  5%|▌         | 132/2416 [02:34<27:09,  1.40it/s]  6%|▌         | 133/2416 [02:35<24:04,  1.58it/s]  6%|▌         | 134/2416 [02:37<42:31,  1.12s/it]  6%|▌         | 135/2416 [02:37<34:12,  1.11it/s]  6%|▌         | 136/2416 [02:39<37:45,  1.01it/s]  6%|▌         | 137/2416 [02:41<54:00,  1.42s/it]  6%|▌         | 139/2416 [02:41<38:33,  1.02s/it]  6%|▌         | 141/2416 [02:41<28:29,  1.33it/s]  6%|▌         | 142/2416 [02:42<30:09,  1.26it/s]  6%|▌         | 143/2416 [02:43<27:40,  1.37it/s]  6%|▌         | 145/2416 [02:43<21:25,  1.77it/s]  6%|▌         | 146/2416 [02:44<20:00,  1.89it/s]  6%|▌         | 147/2416 [02:46<33:50,  1.12it/s]  6%|▌         | 148/2416 [02:47<43:31,  1.15s/it]  6%|▌         | 149/2416 [02:48<41:42,  1.10s/it]  6%|▌         | 150/2416 [02:49<40:21,  1.07s/it]  6%|▋         | 151/2416 [02:49<29:44,  1.27it/s]  6%|▋         | 152/2416 [02:50<33:11,  1.14it/s]  6%|▋         | 153/2416 [02:51<28:15,  1.33it/s]  6%|▋         | 154/2416 [02:51<23:03,  1.63it/s]  6%|▋         | 155/2416 [02:52<21:08,  1.78it/s]  6%|▋         | 156/2416 [02:52<20:28,  1.84it/s]  6%|▋         | 157/2416 [02:53<21:30,  1.75it/s]  7%|▋         | 158/2416 [02:54<31:13,  1.21it/s]  7%|▋         | 159/2416 [02:54<23:38,  1.59it/s]  7%|▋         | 160/2416 [02:55<28:51,  1.30it/s]  7%|▋         | 161/2416 [02:57<35:09,  1.07it/s]  7%|▋         | 162/2416 [02:57<31:06,  1.21it/s]  7%|▋         | 163/2416 [02:58<28:16,  1.33it/s]  7%|▋         | 164/2416 [02:59<33:15,  1.13it/s]  7%|▋         | 165/2416 [02:59<26:32,  1.41it/s]  7%|▋         | 166/2416 [03:00<20:01,  1.87it/s]  7%|▋         | 168/2416 [03:00<15:06,  2.48it/s]  7%|▋         | 169/2416 [03:00<16:14,  2.31it/s]  7%|▋         | 170/2416 [03:00<13:21,  2.80it/s]  7%|▋         | 172/2416 [03:01<12:38,  2.96it/s]  7%|▋         | 173/2416 [03:01<12:06,  3.09it/s]  7%|▋         | 174/2416 [03:02<11:44,  3.18it/s]  7%|▋         | 175/2416 [03:03<20:24,  1.83it/s]  7%|▋         | 176/2416 [03:03<20:44,  1.80it/s]  7%|▋         | 177/2416 [03:04<19:27,  1.92it/s]  7%|▋         | 178/2416 [03:05<33:11,  1.12it/s]  7%|▋         | 179/2416 [03:06<24:26,  1.53it/s]  7%|▋         | 180/2416 [03:06<19:05,  1.95it/s]  7%|▋         | 181/2416 [03:07<21:31,  1.73it/s]  8%|▊         | 182/2416 [03:07<20:39,  1.80it/s]  8%|▊         | 183/2416 [03:10<43:49,  1.18s/it]  8%|▊         | 184/2416 [03:11<46:51,  1.26s/it]  8%|▊         | 185/2416 [03:11<34:31,  1.08it/s]  8%|▊         | 186/2416 [03:12<28:31,  1.30it/s]  8%|▊         | 187/2416 [03:13<34:37,  1.07it/s]  8%|▊         | 188/2416 [03:13<27:56,  1.33it/s]  8%|▊         | 189/2416 [03:14<25:58,  1.43it/s]  8%|▊         | 190/2416 [03:15<29:08,  1.27it/s]  8%|▊         | 191/2416 [03:19<1:05:50,  1.78s/it]  8%|▊         | 192/2416 [03:19<49:00,  1.32s/it]    8%|▊         | 193/2416 [03:21<52:09,  1.41s/it]  8%|▊         | 194/2416 [03:21<40:15,  1.09s/it]  8%|▊         | 195/2416 [03:25<1:07:32,  1.82s/it]  8%|▊         | 196/2416 [03:29<1:29:45,  2.43s/it]Traceback (most recent call last):
  File "pmi-accuracy/pmi-accuracy.py", line 362, in <module>
    MEAN_SCORES = report_uuas_n(OBSERVATIONS, RESULTS_DIR, n_obs=CLI_ARGS.n_observations, device=DEVICE, verbose=True)
  File "pmi-accuracy/pmi-accuracy.py", line 291, in report_uuas_n
    scores, unks = score_observation(observation, device=device, use_tokenizer=False, verbose=verbose)
  File "pmi-accuracy/pmi-accuracy.py", line 252, in score_observation
    pmi_matrix = get_pmi_matrix_from_ids(input_ids, device=device, verbose=verbose)
  File "pmi-accuracy/pmi-accuracy.py", line 108, in get_pmi_matrix_from_ids
    target_mapping=target_mapping.to(device))
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/transformers/modeling_xlnet.py", line 960, in forward
    inputs_embeds=inputs_embeds)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/transformers/modeling_xlnet.py", line 858, in forward
    head_mask=head_mask[i])
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/transformers/modeling_xlnet.py", line 436, in forward
    head_mask=head_mask)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/transformers/modeling_xlnet.py", line 351, in forward
    q_head_g, k_head_h, v_head_h, k_head_r, seg_mat=seg_mat, attn_mask=attn_mask_g, head_mask=head_mask)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/transformers/modeling_xlnet.py", line 261, in rel_attn_core
    bd = torch.einsum('ibnd,jbnd->bnij', q_head + self.r_r_bias, k_head_r)
  File "/data/anaconda/envs/pmienv/lib/python3.7/site-packages/torch/functional.py", line 241, in einsum
    return torch._C._VariableFunctions.einsum(equation, operands)
RuntimeError: CUDA out of memory. Tried to allocate 1.91 GiB (GPU 0; 15.90 GiB total capacity; 12.51 GiB already allocated; 219.88 MiB free; 15.05 GiB reserved in total by PyTorch)
  8%|▊         | 196/2416 [03:29<39:37,  1.07s/it]  
